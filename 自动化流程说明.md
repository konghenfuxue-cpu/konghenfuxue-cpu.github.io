# 🤖 博客自动化流程说明

本博客配置了多个 GitHub Actions 自动化工作流,帮助你更高效地管理博客。

## 📋 已配置的自动化流程

### 1. 🖼️ 自动压缩图片
**文件**: `.github/workflows/compress-images.yml`

**功能**: 
- 自动压缩上传的图片(JPG/PNG/WebP)
- 减小图片大小,提高网站加载速度
- 保持图片质量在 85%

**触发条件**:
- 推送包含图片文件的提交时
- 可手动触发

**使用建议**: ✅ 保留 - 非常实用!

---

### 2. 🔗 检查失效链接
**文件**: `.github/workflows/check-links.yml`

**功能**:
- 检查博客中的所有链接是否有效
- 发现失效链接时自动创建 Issue
- 每周自动检查一次

**触发条件**:
- 每周日凌晨 2 点自动运行
- 修改文章时运行
- 可手动触发

**使用建议**: ✅ 推荐使用

---

### 3. 💾 自动备份博客
**文件**: `.github/workflows/auto-backup.yml`

**功能**:
- 每天自动备份博客内容
- 创建带日期的备份分支
- 自动清理 30 天前的旧备份

**触发条件**:
- 每天凌晨 3 点自动运行
- 可手动触发

**使用建议**: ✅ 强烈推荐 - 数据安全很重要!

---

### 4. 📑 生成文章索引
**文件**: `.github/workflows/generate-index.yml`

**功能**:
- 自动生成文章目录索引
- 按年份分类整理
- 创建 `ARTICLES_INDEX.md` 文件

**触发条件**:
- 添加或修改文章时
- 可手动触发

**使用建议**: ✅ 推荐使用

---

### 5. 👋 欢迎新访客
**文件**: `.github/workflows/welcome.yml`

**功能**:
- 自动欢迎第一次提交 Issue 的用户
- 为评论自动添加表情反应
- 增加互动性

**触发条件**:
- 有新 Issue 创建时
- 有新评论时

**使用建议**: ⭐ 可选 - 增加友好度

---

### 6. 🚀 构建和部署
**文件**: `.github/workflows/deploy.yml`

**功能**:
- 自动构建 Jekyll 网站
- 部署到 GitHub Pages
- 优化构建过程

**触发条件**:
- 推送到 master 分支时
- 可手动触发

**使用建议**: ✅ 必需 - 网站部署核心!

---

### 7. 🔍 SEO 优化检查
**文件**: `.github/workflows/seo-check.yml`

**功能**:
- 检查文章标题长度是否合适
- 检查是否缺少描述
- 生成 SEO 优化报告

**触发条件**:
- 修改文章或配置时
- 可手动触发

**使用建议**: ⭐ 推荐 - 帮助提高搜索排名

---

## 🎯 如何使用这些自动化

### 查看运行状态

1. 访问: https://github.com/konghenfuxue-cpu/konghenfuxue-cpu.github.io/actions
2. 查看所有工作流的运行历史
3. 绿色✅表示成功,红色❌表示失败

### 手动触发工作流

1. 进入 **Actions** 标签
2. 选择想要运行的工作流
3. 点击 **Run workflow** 按钮
4. 选择分支并确认

### 启用/禁用工作流

1. 进入 **Actions** 标签
2. 选择工作流
3. 点击右上角的 **...** 菜单
4. 选择 **Disable workflow** 或 **Enable workflow**

## ⚙️ 配置权限(重要!)

为了让这些自动化正常工作,需要配置权限:

1. 进入仓库 **Settings** → **Actions** → **General**
2. 在 **Workflow permissions** 部分:
   - ✅ 选择 **Read and write permissions**
   - ✅ 勾选 **Allow GitHub Actions to create and approve pull requests**
3. 点击 **Save**

## 📊 各自动化的资源消耗

| 工作流 | 频率 | 时长 | 资源消耗 |
|--------|------|------|----------|
| 压缩图片 | 按需 | 1-3分钟 | 低 |
| 检查链接 | 每周 | 2-5分钟 | 中 |
| 自动备份 | 每天 | <1分钟 | 极低 |
| 生成索引 | 按需 | <1分钟 | 极低 |
| 欢迎访客 | 按需 | <10秒 | 极低 |
| 构建部署 | 每次推送 | 2-4分钟 | 中 |
| SEO检查 | 按需 | 1-2分钟 | 低 |

**总计**: 免费账户每月 2000 分钟,完全够用! ✅

## 🔧 自定义建议

### 修改定时任务

编辑 `.github/workflows/*.yml` 文件中的 `cron` 表达式:

```yaml
schedule:
  - cron: '0 2 * * 0'  # 每周日凌晨2点
  # 格式: 分 时 日 月 周
  # 0 0 * * * = 每天午夜
  # 0 */6 * * * = 每6小时
```

### 添加通知

可以配置工作流失败时发送邮件或消息:

```yaml
- name: 发送通知
  if: failure()
  uses: dawidd6/action-send-mail@v3
  with:
    server_address: smtp.gmail.com
    server_port: 465
    username: ${{ secrets.EMAIL_USERNAME }}
    password: ${{ secrets.EMAIL_PASSWORD }}
    subject: 工作流失败通知
    to: your-email@example.com
    from: GitHub Actions
    body: 自动化任务执行失败,请检查!
```

## 📝 推荐配置

### 最小配置(必需)
- ✅ 构建和部署
- ✅ 压缩图片

### 标准配置(推荐)
- ✅ 构建和部署
- ✅ 压缩图片
- ✅ 自动备份
- ✅ 生成文章索引

### 完整配置(最佳)
- ✅ 所有工作流

## 🆘 故障排除

### 工作流失败
1. 检查 Actions 权限是否已开启
2. 查看失败日志找出具体错误
3. 确认 secrets 是否配置正确

### 权限错误
- 错误信息: `Permission denied`
- 解决: 在 Settings → Actions → General 中开启写权限

### 分支不匹配
- 错误信息: `branch not found`
- 解决: 修改工作流文件中的分支名为 `master`

## 🎓 学习资源

- [GitHub Actions 官方文档](https://docs.github.com/cn/actions)
- [工作流语法](https://docs.github.com/cn/actions/using-workflows/workflow-syntax-for-github-actions)
- [市场中的 Actions](https://github.com/marketplace?type=actions)

---

**提示**: 所有自动化都是可选的,根据需求选择启用!
