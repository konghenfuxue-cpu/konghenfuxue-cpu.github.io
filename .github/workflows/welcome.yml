name: æ¬¢è¿æ–°è®¿å®¢

on:
  issues:
    types: [opened]
  issue_comment:
    types: [created]
  discussion:
    types: [created]
  discussion_comment:
    types: [created]

jobs:
  welcome:
    runs-on: ubuntu-latest
    permissions:
      issues: write
      discussions: write
    
    steps:
      - name: æ¬¢è¿æ–°çš„ Issue æäº¤è€…
        if: github.event_name == 'issues'
        uses: actions/github-script@v7
        with:
          script: |
            const issue = context.payload.issue;
            const creator = context.payload.sender.login;
            
            // æ£€æŸ¥æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡æäº¤ issue
            const issues = await github.rest.issues.listForRepo({
              owner: context.repo.owner,
              repo: context.repo.repo,
              creator: creator,
              state: 'all'
            });
            
            if (issues.data.length === 1) {
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issue.number,
                body: `ğŸ‘‹ æ¬¢è¿ @${creator}ï¼\n\næ„Ÿè°¢ä½ æäº¤ç¬¬ä¸€ä¸ª Issue!æˆ‘ä¼šå°½å¿«æŸ¥çœ‹å¹¶å›å¤ã€‚\n\nå¦‚æœä½ å¯¹è¿™ä¸ªåšå®¢æœ‰ä»»ä½•å»ºè®®æˆ–å‘ç°äº†é—®é¢˜,æ¬¢è¿éšæ—¶åé¦ˆ! ğŸ˜Š`
              });
            }

      - name: æ„Ÿè°¢è¯„è®ºè€…
        if: github.event_name == 'issue_comment'
        uses: actions/github-script@v7
        with:
          script: |
            const commenter = context.payload.sender.login;
            const owner = context.repo.owner;
            
            if (commenter !== owner) {
              // éšæœºé€‰æ‹©ä¸€ä¸ªè¡¨æƒ…
              const emojis = ['ğŸ‘', 'ğŸ’¯', 'ğŸ™', 'âœ¨', 'ğŸ‰', 'â¤ï¸'];
              const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];
              
              await github.rest.reactions.createForIssueComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                comment_id: context.payload.comment.id,
                content: '+1'
              });
            }
